name: Minikube Cluster

on:
  push:
    branches:
      - main

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - name: Set up Minikube
        run: |
          # Install Minikube
          curl -Lo minikube https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64
          chmod +x minikube
          sudo mv minikube /usr/local/bin/

          # Start Minikube
          minikube start --driver=docker

      - name: Deploy Kubernetes resources
        run: |
          # Apply deployment.yaml file from the kubernetes-configs folder
          kubectl apply -f group-project-devops-repo/deployment.yaml

      - name: Verify deployment
        run: |
          # Check if resources are deployed
          kubectl get pods
          kubectl get deployments
          kubectl get services
        # Optional: You can add more commands to verify the deployment as needed
